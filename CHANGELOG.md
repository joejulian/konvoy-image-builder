# Changelog

## [1.6.0](https://www.github.com/joejulian/konvoy-image-builder/compare/v1.5.1...v1.6.0) (2022-01-05)


### Features

* add nvidia driver support ([ee6553a](https://www.github.com/joejulian/konvoy-image-builder/commit/ee6553a3fb76f8dd8e49b74059ac012c407d3f76))
* adds a rhel 8 packer build ([ae94571](https://www.github.com/joejulian/konvoy-image-builder/commit/ae9457178b5d89ea68722eb297ec65ab2656b48b))
* adds goss validation for rhel ([3a72a50](https://www.github.com/joejulian/konvoy-image-builder/commit/3a72a5026c45dff2f88a7d20a93caf4e370b5ec2))
* adds instance type override option to build app ([c57bf18](https://www.github.com/joejulian/konvoy-image-builder/commit/c57bf186800fd19d6b4f041f89b809da4c3d0b9e))
* adds nvidia-container-toolkit and setup ([7bd1d3e](https://www.github.com/joejulian/konvoy-image-builder/commit/7bd1d3e35b013eddcb5bb5acb26b16de6c77b9cd))
* adds RHEL 8.4 packer config ([#128](https://www.github.com/joejulian/konvoy-image-builder/issues/128)) ([44967dd](https://www.github.com/joejulian/konvoy-image-builder/commit/44967dd5df4e97c3934734000c2858f3e5d7b989))
* bump Containerd to 1.4.11 ([#127](https://www.github.com/joejulian/konvoy-image-builder/issues/127)) ([339424d](https://www.github.com/joejulian/konvoy-image-builder/commit/339424da56068c00e3dfa7af08a8d8d32ae0e3fe))
* bump k8s to v1.21.6 ([b2fcdc5](https://www.github.com/joejulian/konvoy-image-builder/commit/b2fcdc5533a73f38200c2b278b903de191ce8360))
* disable firewalld and flush Iptable rules ([#156](https://www.github.com/joejulian/konvoy-image-builder/issues/156)) ([9924865](https://www.github.com/joejulian/konvoy-image-builder/commit/9924865e9cb77fb7b60f51b6d6e5812c4a6430a0))
* os package bundle  ([#176](https://www.github.com/joejulian/konvoy-image-builder/issues/176)) ([dba46ae](https://www.github.com/joejulian/konvoy-image-builder/commit/dba46aebd4abd806621f30a9c9054f7f25033cd6))
* push image on release ([52a05f2](https://www.github.com/joejulian/konvoy-image-builder/commit/52a05f294ca360a6efc46d833e81f00b92cfc1ee))
* remove image.yaml argument from provision ([dc99b7e](https://www.github.com/joejulian/konvoy-image-builder/commit/dc99b7e66501d4f1f448efa97ef12bfff7cd98b2))
* remove outdated packages and unarchive again on changes ([3d54f5c](https://www.github.com/joejulian/konvoy-image-builder/commit/3d54f5c810e665e98aa5b83d5ac20f8ddb9ca13e))
* remove special variables for flatcar provisions ([e1fca56](https://www.github.com/joejulian/konvoy-image-builder/commit/e1fca56fb0c815c68cc225c2449fd020e6054a42))
* RHEL 8.4, RHEL 8.2 & RHEL 7.9 GPU support ([#135](https://www.github.com/joejulian/konvoy-image-builder/issues/135)) ([a4163a3](https://www.github.com/joejulian/konvoy-image-builder/commit/a4163a37113ac3940106f19b2c85c2b8efeea67d))
* set cloudinit feature flag ([f26bdf5](https://www.github.com/joejulian/konvoy-image-builder/commit/f26bdf58bdf46448c07740d736aa005e922e41ed))
* **suse-nvidia:** initial suse driver install version ([94c309b](https://www.github.com/joejulian/konvoy-image-builder/commit/94c309bcf81733cb189fb880b3d079b2f473f226))
* **suse:** add initial suse support ([c1c1780](https://www.github.com/joejulian/konvoy-image-builder/commit/c1c17801a6941981f42f029faa5df51eab286552))
* **suse:** add initial suse support ([5e55990](https://www.github.com/joejulian/konvoy-image-builder/commit/5e559903db737e67e50461ccead64751479e9d24))
* **suse:** add initial suse support ([3c13e4b](https://www.github.com/joejulian/konvoy-image-builder/commit/3c13e4bf22130b3f740c468b47e4da609cf3b6eb))
* update to Containerd 1.4.7 ([5094617](https://www.github.com/joejulian/konvoy-image-builder/commit/5094617664dd2b256fa1ae9b79a94ccdd2368a67))
* update to Kubernetes v1.21.3 and coredns and pause images ([b0a8451](https://www.github.com/joejulian/konvoy-image-builder/commit/b0a8451c00d9ac631061281c97ecb760c474dc21))
* Upgrade NVIDIA GPU drivers to 470.x  ([#96](https://www.github.com/joejulian/konvoy-image-builder/issues/96)) ([eb7bfe0](https://www.github.com/joejulian/konvoy-image-builder/commit/eb7bfe04c6527dfd1dc4e15f2ce71b60cea5400e))


### Bug Fixes

* (flatcar) restart containerd upon reconfig ([f9a2ea7](https://www.github.com/joejulian/konvoy-image-builder/commit/f9a2ea79d1cde43158f25909589613439e64d989))
* (redhat) restart containerd upon reconfig ([2ec9a23](https://www.github.com/joejulian/konvoy-image-builder/commit/2ec9a2306c193184348acfcf2a57052acac3ca74))
* add ignore to lint issues ([95e80f0](https://www.github.com/joejulian/konvoy-image-builder/commit/95e80f0bcce74504042746e19375c240218122ed))
* add missing RPMs needed for CentOS 7 minimal ([1b54d34](https://www.github.com/joejulian/konvoy-image-builder/commit/1b54d34d425843d346af102ffe2da773368d4c21))
* adds more conditions for iptables service ([#169](https://www.github.com/joejulian/konvoy-image-builder/issues/169)) ([386041a](https://www.github.com/joejulian/konvoy-image-builder/commit/386041a1ea57ef8b954d6c0a6a748d1af52a5c0f))
* allow for setting disksize in ec2_gpu target ([64e1d18](https://www.github.com/joejulian/konvoy-image-builder/commit/64e1d18d5baa89ceee3b948bdaa013906e1e7fe4))
* allows for selecting nvidia runtime via docker cli ([a6b89f9](https://www.github.com/joejulian/konvoy-image-builder/commit/a6b89f9eb863afe10b9592863f015c80ce4c4082))
* always select x86_64 arch for Flatcar ([#171](https://www.github.com/joejulian/konvoy-image-builder/issues/171)) ([d8b792b](https://www.github.com/joejulian/konvoy-image-builder/commit/d8b792b562a30549880360575675845015e4c367))
* apply suggestions from code review to clean up build name and examples ([6151b30](https://www.github.com/joejulian/konvoy-image-builder/commit/6151b30332c7e59dd733c1d85a2d908c2277ec5c))
* bring back mystery pause image ([fcc2ae8](https://www.github.com/joejulian/konvoy-image-builder/commit/fcc2ae8953b81df5b8e4dcf430a1cb9f77dc86cd))
* **centos:** disable firewalld for nvidia installs ([4cb340c](https://www.github.com/joejulian/konvoy-image-builder/commit/4cb340cc176ffe660656967b02e71e48e37b2d86))
* change kubelet and kubeadm sysusr prefix ([272831b](https://www.github.com/joejulian/konvoy-image-builder/commit/272831bfab6e1e97693575758c17e812a8a2408b))
* check cloud init version as well ([eb307f7](https://www.github.com/joejulian/konvoy-image-builder/commit/eb307f732cd0992cb658fd69e1248577ccf1a041))
* Containerd Flatcard version ([32ddf7e](https://www.github.com/joejulian/konvoy-image-builder/commit/32ddf7e6372386c316b791d76aeba47fb4161474))
* debian installs to dist-packages when installing cloud init. Carve ([ce92e75](https://www.github.com/joejulian/konvoy-image-builder/commit/ce92e75b7531abbd22f45d7da218158143d998b0))
* don't run goreleaser on PRs ([a620aaf](https://www.github.com/joejulian/konvoy-image-builder/commit/a620aaf163d798d90c0e911409edbce2fa3ce663))
* ec2_gpu exclusive run handler for systemd reload ([a1ba975](https://www.github.com/joejulian/konvoy-image-builder/commit/a1ba9751312e3f20e0a76af03e0255cdd76c7ad5))
* enable centos 8 and nvidia ci builds ([872d2b7](https://www.github.com/joejulian/konvoy-image-builder/commit/872d2b72363922799d534cb8e2c67ff55b58f871))
* fixes undefined variables in flatcar ec2_gpu runs ([d061a11](https://www.github.com/joejulian/konvoy-image-builder/commit/d061a11c10d11f277a9a366b77de210ec4f8a7f2))
* lint errors ([46a6b19](https://www.github.com/joejulian/konvoy-image-builder/commit/46a6b195ca8528b19fa171e21f739d1f5cc8e951))
* lint errors ([53586e0](https://www.github.com/joejulian/konvoy-image-builder/commit/53586e00b7c2a55d666a329f114de2bb56b7270c))
* makes docs ([9d7ec72](https://www.github.com/joejulian/konvoy-image-builder/commit/9d7ec72f87a3ce40250344eb01c1d46b0e0dd7be))
* match CNI version ([aa6255b](https://www.github.com/joejulian/konvoy-image-builder/commit/aa6255ba3a2b28a90c96452aac33221b0fbb6476))
* no default container runtime and set the socket to be in docker again ([629e306](https://www.github.com/joejulian/konvoy-image-builder/commit/629e306339fbcd47ec797593c1d4e7f8f04d04d8))
* nvidia driver on centos7 installation ([21715e2](https://www.github.com/joejulian/konvoy-image-builder/commit/21715e2b5efc7410ebb685cf073f33759a3afe87))
* nvidia driver on centos7 installation ([6113112](https://www.github.com/joejulian/konvoy-image-builder/commit/611311230adff6790972bf826f185b126b1629b6))
* nvidia driver on centos7 installation ([db34d1b](https://www.github.com/joejulian/konvoy-image-builder/commit/db34d1b243ec32b6067cae406fc25a3e73c0c5c8))
* override flags not passed on generate command ([34a410e](https://www.github.com/joejulian/konvoy-image-builder/commit/34a410e85bdd3e01bed729c659cbb2d5bdf34b22))
* prevents use of cgroupsv2 for flatcar gpu ([6a7546b](https://www.github.com/joejulian/konvoy-image-builder/commit/6a7546b90d644969278c75d9d79ccf2ad95ac334))
* propogate release variables to buildkit run ([5ef5c3c](https://www.github.com/joejulian/konvoy-image-builder/commit/5ef5c3c55748b347cc2d16257702b4d304b553f5))
* remove crictl socket info ([e7abd91](https://www.github.com/joejulian/konvoy-image-builder/commit/e7abd919a5ac3d20a78c73211e86c9af4193abdf))
* remove refs to subscription manager ([51d2229](https://www.github.com/joejulian/konvoy-image-builder/commit/51d2229b2a7452a5da746ce0f015c55201bdfdd8))
* removes spaces from yum package names ([d8bb1b8](https://www.github.com/joejulian/konvoy-image-builder/commit/d8bb1b886fa2ee35b7014022966339f830792683))
* RHEL8.2 now needs GPU nodes for builds and tests ([#142](https://www.github.com/joejulian/konvoy-image-builder/issues/142)) ([a2f92ce](https://www.github.com/joejulian/konvoy-image-builder/commit/a2f92ceb6241470669578cdc5ad17942bdcc46de))
* run make docs for generate ([29091b1](https://www.github.com/joejulian/konvoy-image-builder/commit/29091b1a06c5fb3a0973b0bac077b1760d7477d6))
* run make docs to fix broken tests ([22ffc33](https://www.github.com/joejulian/konvoy-image-builder/commit/22ffc330869ef89a68275211cc98fae17aa5a939))
* sed replacement ([6f68a11](https://www.github.com/joejulian/konvoy-image-builder/commit/6f68a116f2f2b6d137c09229e7d0149227d93bcb))
* set AWS_DEFAULT_REGION ([9850a74](https://www.github.com/joejulian/konvoy-image-builder/commit/9850a745b75e9e0f3500c12e86491ad9f49e4647))
* set correct path for kubelet service ([2bb596e](https://www.github.com/joejulian/konvoy-image-builder/commit/2bb596e94d663a19de58465b45731d68e5ca94de))
* set language in code block ([9ee8b7f](https://www.github.com/joejulian/konvoy-image-builder/commit/9ee8b7f5b09b93682397b1b66119c9fe7363f3ff))
* template containerd config correctly with correct runtime endpoint ([504e73a](https://www.github.com/joejulian/konvoy-image-builder/commit/504e73a2dad153e8d3c1ef6bb97930bcd7502fa2))
* update docs ([31749c9](https://www.github.com/joejulian/konvoy-image-builder/commit/31749c9f09dcfb45aeab6a6deb4ae7dbc07f0b5f))
* update for upcoming linter bump ([#155](https://www.github.com/joejulian/konvoy-image-builder/issues/155)) ([700ff91](https://www.github.com/joejulian/konvoy-image-builder/commit/700ff91f824bdfb3c182483fe601451bbe1cbdb9))
* updates invalid PHONY attribute ([#134](https://www.github.com/joejulian/konvoy-image-builder/issues/134)) ([3fdc298](https://www.github.com/joejulian/konvoy-image-builder/commit/3fdc298f0acb9d9682b08265ff9aee44e5ac699a))
* updates kernel source retrieval ([2cfdb6b](https://www.github.com/joejulian/konvoy-image-builder/commit/2cfdb6be2fa5924f8051649bcb3ea931ef474741))
* use "v" in versions ([3e57aae](https://www.github.com/joejulian/konvoy-image-builder/commit/3e57aae595cde0a1d605d437be0354acbadc1322))
* use dev/xvda as default volume for flatcar ([d350a26](https://www.github.com/joejulian/konvoy-image-builder/commit/d350a26d88ff667588f7025a0f2ea030bcb8b571))
* use t3 small instances for molecule rhel tests ([2d4fcde](https://www.github.com/joejulian/konvoy-image-builder/commit/2d4fcdece69236b4d1cb1ee61464d3341705a944))
* use the same pause image version in containerd config ([45fd587](https://www.github.com/joejulian/konvoy-image-builder/commit/45fd587b0ee600ed9ffcd87fccba366fc20ee8a3))
* wire up provision flags correctly ([5e03de0](https://www.github.com/joejulian/konvoy-image-builder/commit/5e03de08a566c2948a69e1b682703a71fbbfc6fe))
* yaml stylecheck ([ae3aafe](https://www.github.com/joejulian/konvoy-image-builder/commit/ae3aafe8f255639162beb5cd3852f98daae1265f))
* zypper repo always updates ([5ab770e](https://www.github.com/joejulian/konvoy-image-builder/commit/5ab770e0d25e6e553357bda12b65be835f8032ae))
